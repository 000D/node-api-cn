
以下 flag 用于接受字符串的 `flag` 选项：

* `'a'` - 打开文件用于追加。如果文件不存在则创建文件。

* `'ax'` - 类似 `'a'`，但如果文件存在则失败。

* `'a+'` - 打开文件用于读取和追加。如果文件不存在则创建文件。

* `'ax+'` - 类似 `'a+'`，但如果文件存在则失败。

* `'as'` - 在同步模式中打开文件用于追加。如果文件不存在则创建文件。

* `'as+'` - 在同步模式中打开文件用于读取和追加。如果文件不存在则创建文件。

* `'r'` - 打开文件用于读取。如果文件不存在则抛出异常。

* `'r+'` - 打开文件用于读取和写入。如果文件不存在则抛出异常。

* `'rs+'` - 在同步模式中打开文件用于读取和写入。指示操作系统绕开本地文件系统缓存。

  这个主要用于在 NFS 挂载上打开文件，因为它允许跳过可能存在的本地缓存。
  它对 I/O 性能有较大影响，除非需要否则不建议使用这个 flag。

  注意，它不会将 `fs.open()` 或 `fsPromises.open()` 变成同步的阻塞调用。
  如果期望同步的操作，应该使用类似 `fs.openSync()` 的方法。

* `'w'` - 打开文件用于写入。文件会被创建（如果不存在）或截断（如果存在）。

* `'wx'` - 类似 `'w'`，但如果文件存在则失败。

* `'w+'` - 打开文件用于读取和写入。文件会被创建（如果不存在）或截断（如果存在）。

* `'wx+'` - 类似 `'w+'`，但如果文件存在则失败。

`flag` 也可以是一个数值，详见 open(2)。
常用的常量定义在 `fs.constants`。
在 Windows 上，flag 会被转换为等效的 flag，例如 `O_WRONLY` 转换为 `FILE_GENERIC_WRITE`、`O_EXCL|O_CREAT` 转换为 `CREATE_NEW`。

独有的 `'x'` flag（ open(2) 中的 `O_EXCL` flag）确保路径是新创建的。
在 POSIX 系统上，即使是指向不存在的文件的符号链接，路径也会被视为已存在。
这个 flag 在网络文件系统中可能无效。

在 Linux 上，当文件以追加模式打开时，指定位置的写入无效。
内核会忽视位置参数，且总是追加数据到文件的尾部。

若要修改文件而不是覆盖文件，则 flag 模式需要为 `'r+'` 而不是默认的 `'w'`。

一些 flag 的行为与平台有关。
例如，在 macOS 和 Linux 上，以 `'a+'` flag 打开一个目录会返回错误。
但在 Windows 和 FreeBSD 上，则返回一个文件描述符或 `FileHandle`。

```js
// 在 macOS 和 Linux 上：
fs.open('<目录>', 'a+', (err, fd) => {
  // => [Error: EISDIR: illegal operation on a directory, open <directory>]
});

// 在 Windows 和 FreeBSD 上：
fs.open('<目录>', 'a+', (err, fd) => {
  // => null, <fd>
});
```

在 Windows 上，使用 `'w'` flag（无论是 `fs.open()` 或 `fs.writeFile()` 或 `fsPromises.open()`）打开一个现有的隐藏文件会抛出 `EPERM` 失败。
现有的隐藏文件可以使用 `'r+'` flag 打开用于写入。

调用 `fs.ftruncate()` 或 `fsPromises.ftruncate()` 可以用于重置文件内容。


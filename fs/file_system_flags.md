
`flag` 可选的值如下：

* `'a'` - 打开文件用于追加。如果文件不存在则创建文件。

* `'ax'` - 类似 `'a'`，但如果文件已存在则抛出异常。

* `'a+'` - 打开文件用于读取和追加。如果文件不存在则创建文件。

* `'ax+'` - 类似 `'a+'`，但如果文件已存在则抛出异常。

* `'as'` - 以同步模式打开文件用于追加。如果文件不存在则创建文件。

* `'as+'` - 以同步模式打开文件用于读取和追加。如果文件不存在则创建文件。

* `'r'` - 打开文件用于读取。如果文件不存在则抛出异常。

* `'r+'` - 打开文件用于读取和写入。如果文件不存在则抛出异常。

* `'rs+'` - 以同步模式打开文件用于读取和写入。指示操作系统绕开本地文件系统缓存。

  主要用于在 NFS 挂载上打开文件，可以跳过可能存在的本地缓存。
  对 I/O 性能有较大影响，除非需要否则不建议使用。

  不会将 `fs.open()` 或 `fsPromises.open()` 变成同步的阻塞调用。
  如果期望同步的操作，应该使用类似 `fs.openSync()` 的方法。

* `'w'` - 打开文件用于写入。如果文件不存在，则创建文件；如果文件已存在，则截断文件。

* `'wx'` - 类似 `'w'`，但如果文件已存在则抛出异常。

* `'w+'` - 打开文件用于读取和写入。如果文件不存在，则创建文件；如果文件已存在，则截断文件。

* `'wx+'` - 类似 `'w+'`，但如果文件已存在则抛出异常。

`flag` 也可以是一个数值，参见 open(2)。
常用的常量都定义在 `fs.constants` 上。
在 Windows 上，`flag` 会被转换成等效的其他 `flag`，例如 `O_WRONLY` 转换成 `FILE_GENERIC_WRITE`、`O_EXCL|O_CREAT` 转换成 `CREATE_NEW`。

`'x'`（ open(2) 中的 `O_EXCL`）可以确保文件是新创建的。
在 POSIX 系统上，即使是指向不存在的文件的符号链接，也会视为文件已存在。
该 `flag` 在网络文件系统中可能无效。

在 Linux 上，当以追加模式打开文件时，不能指定写入的位置。
内核会忽略位置参数，总是将数据追加到文件的尾部。

如果要修改文件而不是覆盖文件，则应该使用 `'r+'` 而不是默认的 `'w'`。

有些 `flag` 的行为因平台而异。
例如，在 macOS 和 Linux 上，以 `'a+'` 打开目录会返回错误。
但在 Windows 和 FreeBSD 上，则返回文件描述符或 `FileHandle`。

```js
// 在 macOS 和 Linux 上：
fs.open('<目录>', 'a+', (err, fd) => {
  // => [Error: EISDIR: illegal operation on a directory, open <directory>]
});

// 在 Windows 和 FreeBSD 上：
fs.open('<目录>', 'a+', (err, fd) => {
  // => null, <fd>
});
```

在 Windows 上，使用 `'w'`（无论是 `fs.open()`、`fs.writeFile()` 或 `fsPromises.open()`）打开隐藏文件会抛出 `EPERM`。
隐藏文件可以使用 `'r+'` 打开用于写入。

调用 `fs.ftruncate()` 或 `fsPromises.ftruncate()` 可以用于重置文件的内容。

